---
title: Chapter 3 - Home Manager
description: Using nix to control your home directory, dotfiles but better!
---

Home Manager (often abbrevieted to HM) is a project similar to NixOS, but for a specific user's home folder. You use NixOS to manage system programs, configuration, etc. But Home Manager is programs and configuration for a specific user.

In this chapter we will...

1. Add Home Manager as an input to our flake
2. Learn how to add home manager modules
3. Configure our `.face` file with home manager as an example

## Adding Home Manager as an Input

First things first we need to get home manager as part of our config. To do this we need to add an input to our flake.

In `flake.nix` add a new attr set to the `inputs` attr set called `home-manager` (this can technically be called whatever you like, some people shorten this to `hm`). In this new `home-manager` attr set add `url = "github:nix-community/home-manager";`. Then add `inputs.nixpkgs.follows = "nixpkgs";`.

```nix
inputs = {
    nixpkgs.url = "github:nixos/nixpkgs?ref=nixos-unstable";
    home-manager = {
        url = "github:nix-community/home-manager";
        inputs.nixpkgs.follows = "nixpkgs";
    };
};
```

This tells Nix two things:

1. We have an input named `home-manager` that should be fetched from the `nix-community/home-manager` GitHub repo
2. Home manager itself depends on nixpkgs as an input. To keep thing consistent, we tell Nix to make that input follow our `nixpkgs`

Now, we add `home-manager` as an argument to our `outputs` function:

```nix
outputs = inputs @ { self, nixpkgs, home-manager } let
```

We now have access to home manager in our flake!

## Telling NixOS about home manager

Now we need NixOS to access home manager. First, in our `modules` list we should add `home-manager.nixosModules.home-manager`. This will load the required option into NixOS to use home manager.

Now in our `config.nix` we can configure home manager!

## Configuring Home Manager

In `config.nix` (or a separate module if you feel like it). Create a new attr set called `home-manager`. We're going to fill this with our home config.

- Set `useGlobalPkgs` to `true`, sets HM to use the global nixpkgs instance
- Set `useUserPackages` to `true`
- Set the `extraSpecialArgs` attr set to `inherit inputs;` (like we do for NixOS modules)
- Set `users.YOURNAME` (replacing YOURNAME with your username) to `import ../home/home.nix`

Here you can see we're importing another file. This file will hold a *home manager module*, these are very similar in structure to NixOS modules so I recommend placing them in a different folder from `modules` to differentiate them.

Create `home/home.nix` and give it the contents `{...}: {}` for now.

## Using Home Manager

First things first we'll add these options:

```nix
home = {
    username = "YOURNAME";
    homeDirectory = "/home/YOURNAME";
    stateVersion = "24.11";
};
```

This will tell home manager your username and where your home folder is.

You can split up home manager modules similar to NixOS modules, using the `imports` option.

To find options for home manager use [Home Manager Options Search](https://home-manager-options.extranix.com/?release=master).

## Example: Adding `.face`

To go into a quick use case for HM, we'll add a file to the root of our home folder, `.face`. This file is used by some DEs to know what profile picture to display on the lockscreen, app menu, etc.

1. Place the image file in your config's repo (I like to place any non-nix files in a folder called `res` for resources)
2. `git add .`
3. In an HM module set `home.file.".face".source = ../res/YOURPIC.png;`, replacing YOURPIC.png with the name of the file

Notice how when we want an attribute with a `.` in it, we have to put it in quotes.

We're once again seeing a path without quotes. In short this tells Nix: "While building, copy this file into the nix store and return a string to that nix store path". We'll get into what exactly the Nix store is in another chapter.

This ability to place and link files within your home folder is the bread and butter of Home Manager, you can use it to place any files you want. Many HM options are internally editing or placing files for you.

## When To Use Home Manager

Home manager was created primarily for non-NixOS system, so that at least *part* of your system could be managed by Nix. But it is also useful in NixOS for when you want to do user configuration or make your home folder somewhat declarative. If you ever come across a situation where both HM and NixOS provide an option consider if it should be a *system-wide* change or a *per-user* change, and don't be scared to experiment! You can always rollback.
